# テスト手順

NS Mega Menuプラグインの受け入れテスト手順書です。

## 事前準備

### テスト環境
- WordPress 6.0以上
- PHP 7.4以上（推奨：8.1+）
- 主要ブラウザ（Chrome、Firefox、Safari、Edge）
- モバイルデバイス（iOS Safari、Android Chrome）

### テストサイト準備
1. 新しいWordPressインストール
2. デフォルトテーマ（Twenty Twenty-Four等）を有効化
3. テスト用メニューを作成

## 1. インストール・有効化テスト

### ✅ チェック項目

#### 1.1 プラグインインストール
- [ ] プラグインファイルをアップロード
- [ ] プラグインリストに表示される
- [ ] メタ情報（名前、説明、バージョン）が正しい

#### 1.2 有効化
- [ ] プラグイン有効化でエラーが出ない
- [ ] PHPエラー・警告が出ない
- [ ] データベースエラーが出ない

#### 1.3 管理画面
- [ ] 外観 > メニューが表示される（ブロックテーマでも）
- [ ] メニュー編集画面でカスタムフィールドが表示される

## 2. メニュー設定テスト

### ✅ チェック項目

#### 2.1 基本設定
- [ ] 新しいメニューを作成
- [ ] 親メニュー項目を追加
- [ ] 子メニュー項目を複数追加

#### 2.2 メガメニュー設定
- [ ] 親メニューで「メガメニュー（画像グリッド）」を選択
- [ ] 列数を2-6で変更
- [ ] 設定が保存される

#### 2.3 サムネイル設定
- [ ] 子メニューでメディアライブラリを開く
- [ ] 画像を選択・設定
- [ ] プレビューが表示される
- [ ] 削除ボタンが動作する

## 3. フロントエンド表示テスト

### ✅ チェック項目

#### 3.1 ショートコード
- [ ] `[ns_mega_menu location="primary"]` でメニューが表示される
- [ ] 属性（container、class）が正しく適用される
- [ ] 存在しない location でエラーが出ない

#### 3.2 テンプレートタグ
- [ ] `ns_mega_menu_render()` でメニューが表示される
- [ ] 引数が正しく動作する
- [ ] 旧関数 `nsmm_render_menu()` でdeprecatedが表示される

#### 3.3 メガメニュー表示
- [ ] 通常メニューが適切に表示される
- [ ] 画像グリッドが指定列数で表示される
- [ ] ワイドメニューが適切に表示される
- [ ] サムネイル画像が表示される
- [ ] 説明文が表示される

## 4. インタラクション・レスポンシブテスト

### ✅ チェック項目

#### 4.1 PC操作
- [ ] ホバーでメガメニューが開く
- [ ] ホバー外で閉じる
- [ ] クリックで遷移する
- [ ] キーボード（Tab/Enter/Escape）で操作できる

#### 4.2 モバイル操作
- [ ] タップでメニューが開閉する
- [ ] スクロール時の挙動が適切
- [ ] タッチ操作で遷移する

#### 4.3 レスポンシブ
- [ ] 980px以下でモバイル表示に切り替わる
- [ ] グリッドが縦積みになる
- [ ] フォントサイズが適切に調整される

## 5. 互換性テスト

### ✅ チェック項目

#### 5.1 テーマ互換性
- [ ] ブロックテーマで動作する
- [ ] クラシックテーマで動作する
- [ ] カスタムテーマで衝突しない

#### 5.2 プラグイン互換性
- [ ] 主要キャッシュプラグインと共存
- [ ] 主要SEOプラグインと共存
- [ ] 他のメニュープラグインと共存

## 6. パフォーマンステスト

### ✅ チェック項目

#### 6.1 読み込み速度
- [ ] CSS/JSファイルが適切にキャッシュされる
- [ ] ファイルサイズが妥当（CSS<10KB、JS<5KB）
- [ ] PageSpeed Insightsで90以上維持

#### 6.2 メモリ・クエリ
- [ ] メモリ使用量の増加が最小限
- [ ] 不要なデータベースクエリなし

## 7. セキュリティテスト

### ✅ チェック項目

#### 7.1 権限・nonce
- [ ] 管理者以外がメニュー編集できない
- [ ] nonce検証が動作する
- [ ] CSRF攻撃を防げる

#### 7.2 入出力サニタイズ
- [ ] 悪意のあるHTMLが無効化される
- [ ] JavaScriptインジェクションを防げる
- [ ] SQLインジェクションを防げる

## 8. 多言語・アクセシビリティテスト

### ✅ チェック項目

#### 8.1 国際化
- [ ] 管理画面のテキストが翻訳される
- [ ] POTファイルが正しく生成される
- [ ] 日本語環境で適切に表示される

#### 8.2 アクセシビリティ
- [ ] スクリーンリーダーで読み上げ可能
- [ ] キーボードのみで操作可能
- [ ] 適切なARIA属性が付与される
- [ ] コントラスト比が十分

## 9. エラーハンドリングテスト

### ✅ チェック項目

#### 9.1 異常データ
- [ ] 存在しないメニューIDでエラーが出ない
- [ ] 削除された画像IDでエラーが出ない
- [ ] 不正な列数でデフォルト値になる

#### 9.2 環境問題
- [ ] PHPエラーログにエラーが出ない
- [ ] JavaScriptコンソールにエラーが出ない
- [ ] WordPressデバッグモードで警告が出ない

## 10. アンインストールテスト

### ✅ チェック項目

#### 10.1 無効化・削除
- [ ] プラグイン無効化でエラーが出ない
- [ ] 削除時にオプション削除される（設定による）
- [ ] メニューメタデータが削除される
- [ ] データベースがクリーンになる

## テスト結果記録

### 環境情報
- WordPress バージョン：
- PHP バージョン：
- テーマ：
- 使用ブラウザ：
- テスト実施日：
- プラグインバージョン：0.10.0

### 発見された問題

| 項目 | 問題内容 | 重要度 | ステータス |
|------|----------|--------|------------|
|      |          |        |            |

### 総合評価

- [ ] すべてのテストに合格
- [ ] 軽微な問題があるが公開可能
- [ ] 重要な問題があり修正が必要

## 注意事項

- テストは本番環境に近い環境で実施してください
- 異なるブラウザ・デバイスで必ずテストしてください
- キャッシュプラグインは必ず有効にしてテストしてください
- 問題発見時は詳細な再現手順を記録してください